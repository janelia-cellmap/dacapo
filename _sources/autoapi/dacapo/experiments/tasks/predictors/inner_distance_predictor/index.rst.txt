dacapo.experiments.tasks.predictors.inner_distance_predictor
============================================================

.. py:module:: dacapo.experiments.tasks.predictors.inner_distance_predictor


Attributes
----------

.. autoapisummary::

   dacapo.experiments.tasks.predictors.inner_distance_predictor.logger


Classes
-------

.. autoapisummary::

   dacapo.experiments.tasks.predictors.inner_distance_predictor.InnerDistancePredictor


Module Contents
---------------

.. py:data:: logger

.. py:class:: InnerDistancePredictor(channels: List[str], scale_factor: float)



   Predict signed distances for a binary segmentation task.

   Distances deep within background are pushed to -inf, distances deep within
   the foreground object are pushed to inf. After distances have been
   calculated they are passed through a tanh so that distances saturate at +-1.
   Multiple classes can be predicted via multiple distance channels. The names
   of each class that is being segmented can be passed in as a list of strings
   in the channels argument.

   .. attribute:: channels

      The list of channel names.

      :type: List[str]

   .. attribute:: scale_factor

      The amount by which to scale distances before applying a tanh normalization.

      :type: float

   .. method:: __init__(self, channels

      List[str], scale_factor: float): Initializes the InnerDistancePredictor.

   .. method:: create_model(self, architecture)

      Create the model for the predictor.

   .. method:: create_target(self, gt)

      Create the target array for training.

   .. method:: create_weight(self, gt, target, mask, moving_class_counts=None)

      Create the weight array for training.

   .. method:: output_array_type

      Get the output array type.

   .. method:: process(self, labels

      np.ndarray, voxel_size: Coordinate, normalize=None, normalize_args=None): Process the labels array and convert it to signed distances.

   .. method:: __find_boundaries(self, labels)

      Find the boundaries in a labels array.

   .. method:: __normalize(self, distances, norm, normalize_args)

      Normalize the distances.

   .. method:: gt_region_for_roi(self, target_spec)

      Get the ground-truth region for the given ROI.

   .. method:: padding(self, gt_voxel_size

      Coordinate) -> Coordinate: Get the padding needed for the ground-truth array.

   .. rubric:: Notes

   This is a subclass of Predictor.


   .. py:attribute:: channels


   .. py:attribute:: norm
      :value: 'tanh'



   .. py:attribute:: dt_scale_factor


   .. py:attribute:: max_distance


   .. py:attribute:: epsilon
      :value: 0.05



   .. py:attribute:: threshold
      :value: 0.8



   .. py:property:: embedding_dims

      Get the number of embedding dimensions.

      :returns: The number of embedding dimensions.
      :rtype: int

      :raises NotImplementedError: This method is not implemented.

      .. rubric:: Examples

      >>> embedding_dims = predictor.embedding_dims


   .. py:method:: create_model(architecture)

      Create the model for the predictor.

      :param architecture: The architecture for the model.

      :raises NotImplementedError: This method is not implemented.

      .. rubric:: Examples

      >>> model = predictor.create_model(architecture)



   .. py:method:: create_target(gt)

      Create the target array for training.

      :param gt: The ground-truth array.

      :returns: The DistanceArray.

      :raises NotImplementedError: This method is not implemented.

      .. rubric:: Examples

      >>> predictor.create_target(gt)



   .. py:method:: create_weight(gt, target, mask, moving_class_counts=None)

      Create the weight array for training, given a ground-truth and
      associated target array.

      :param gt: The ground-truth array.
      :param target: The target array.
      :param mask: The mask array.
      :param moving_class_counts: The moving class counts.

      :returns: The weight array and the moving class counts.

      :raises NotImplementedError: This method is not implemented.

      .. rubric:: Examples

      >>> predictor.create_weight(gt, target, mask, moving_class_counts)



   .. py:property:: output_array_type

      Get the output array type.

      :returns: The DistanceArray.

      :raises NotImplementedError: This method is not implemented.

      .. rubric:: Examples

      >>> predictor.output_array_type


   .. py:method:: process(labels: numpy.ndarray, voxel_size: funlib.geometry.Coordinate, normalize=None, normalize_args=None)

      Process the labels array and convert it to signed distances.

      :param labels: The labels array.
      :param voxel_size: The voxel size.
      :param normalize: The normalization method.
      :param normalize_args: The normalization arguments.

      :returns: The signed distances.

      :raises NotImplementedError: This method is not implemented.

      .. rubric:: Examples

      >>> predictor.process(labels, voxel_size, normalize, normalize_args)



   .. py:method:: gt_region_for_roi(target_spec)

      Report how much spatial context this predictor needs to generate a
      target for the given ROI. By default, uses the same ROI.

      :param target_spec: The ROI for which the target is requested.

      :returns: The ROI for which the ground-truth is requested.

      :raises NotImplementedError: This method is not implemented.

      .. rubric:: Examples

      >>> predictor.gt_region_for_roi(target_spec)



   .. py:method:: padding(gt_voxel_size: funlib.geometry.Coordinate) -> funlib.geometry.Coordinate

      Return the padding needed for the ground-truth array.

      :param gt_voxel_size: The voxel size of the ground-truth array.

      :returns: The padding needed for the ground-truth array.

      :raises NotImplementedError: This method is not implemented.

      .. rubric:: Examples

      >>> predictor.padding(gt_voxel_size)



