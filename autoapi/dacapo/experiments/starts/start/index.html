

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dacapo.experiments.starts.start &mdash; DaCapo  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/custom.css" />

  
      <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="dacapo.experiments.starts.start_config" href="../start_config/index.html" />
    <link rel="prev" title="dacapo.experiments.starts.cosem_start_config" href="../cosem_start_config/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            DaCapo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">DaCapo API:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../notebooks/minimal_tutorial.html">Minimal Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../data.html">Data Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../unet_architectures.html">UNet Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tutorial.html">Tutorial: A Simple Experiment in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../docker.html">Docker Configuration for JupyterHub-Dacapo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../aws.html">AWS EC2 Setup Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../cosem_starter.html">Fine-Tune Cosem Starter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../roadmap.html">Road Map</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">dacapo</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../index.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../apply/index.html">dacapo.apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../blockwise/index.html">dacapo.blockwise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../compute_context/index.html">dacapo.compute_context</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html">dacapo.experiments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ext/index.html">dacapo.ext</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gp/index.html">dacapo.gp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../options/index.html">dacapo.options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../plot/index.html">dacapo.plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../predict/index.html">dacapo.predict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../predict_local/index.html">dacapo.predict_local</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../store/index.html">dacapo.store</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tmp/index.html">dacapo.tmp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../train/index.html">dacapo.train</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/index.html">dacapo.utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../validate/index.html">dacapo.validate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#package-contents">Package Contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../cli.html">CLI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">DaCapo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">dacapo</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">dacapo.experiments</a></li>
          <li class="breadcrumb-item"><a href="../index.html">dacapo.experiments.starts</a></li>
      <li class="breadcrumb-item active">dacapo.experiments.starts.start</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/autoapi/dacapo/experiments/starts/start/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dacapo.experiments.starts.start">
<span id="dacapo-experiments-starts-start"></span><h1>dacapo.experiments.starts.start<a class="headerlink" href="#module-dacapo.experiments.starts.start" title="Link to this heading"></a></h1>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dacapo.experiments.starts.start.logger" title="dacapo.experiments.starts.start.logger"><code class="xref py py-obj docutils literal notranslate"><span class="pre">logger</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dacapo.experiments.starts.start.head_keys" title="dacapo.experiments.starts.start.head_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">head_keys</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dacapo.experiments.starts.start.Start" title="dacapo.experiments.starts.start.Start"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Start</span></code></a></p></td>
<td><p>This class interfaces with the dacapo store to retrieve and load the</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dacapo.experiments.starts.start.match_heads" title="dacapo.experiments.starts.start.match_heads"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_heads</span></code></a>(model, head_weights, old_head, new_head)</p></td>
<td><p>Matches the head of the model to the new head by copying the weights</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="dacapo.experiments.starts.start.logger">
<span class="sig-prename descclassname"><span class="pre">dacapo.experiments.starts.start.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#dacapo.experiments.starts.start.logger" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="dacapo.experiments.starts.start.head_keys">
<span class="sig-prename descclassname"><span class="pre">dacapo.experiments.starts.start.</span></span><span class="sig-name descname"><span class="pre">head_keys</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['prediction_head.weight',</span> <span class="pre">'prediction_head.bias',</span> <span class="pre">'chain.1.weight',</span> <span class="pre">'chain.1.bias']</span></em><a class="headerlink" href="#dacapo.experiments.starts.start.head_keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dacapo.experiments.starts.start.match_heads">
<span class="sig-prename descclassname"><span class="pre">dacapo.experiments.starts.start.</span></span><span class="sig-name descname"><span class="pre">match_heads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_head</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.starts.start.match_heads" title="Link to this definition"></a></dt>
<dd><p>Matches the head of the model to the new head by copying the weights
of the old head to the new head. The weights of the old head are
copied to the new head by matching the labels of the old head to the
labels of the new head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – obj
The model to which the weights are to be loaded.</p></li>
<li><p><strong>head_weights</strong> – dict
The weights of the old head.</p></li>
<li><p><strong>old_head</strong> – list
The labels of the old head.</p></li>
<li><p><strong>new_head</strong> – list
The labels of the new head.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>obj</dt><dd><p>The model with the weights of the old head copied to the new
head.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>model</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the old head is not found in the new head, a RuntimeError
exception is thrown which is logged and handled by loading
only the common layers from weights.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">match_heads</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">head_weights</span><span class="p">,</span> <span class="n">old_head</span><span class="p">,</span> <span class="n">new_head</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This function is called by the Start class to match the head of
the model to the new head by copying the weights of the old head
to the new head.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dacapo.experiments.starts.start.Start">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacapo.experiments.starts.start.</span></span><span class="sig-name descname"><span class="pre">Start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.starts.start.Start" title="Link to this definition"></a></dt>
<dd><p>This class interfaces with the dacapo store to retrieve and load the
weights of the starter model used for finetuning.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.starts.start.Start.run">
<span class="sig-name descname"><span class="pre">run</span></span><a class="headerlink" href="#dacapo.experiments.starts.start.Start.run" title="Link to this definition"></a></dt>
<dd><p>str
The specified run to retrieve weights for the model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.starts.start.Start.criterion">
<span class="sig-name descname"><span class="pre">criterion</span></span><a class="headerlink" href="#dacapo.experiments.starts.start.Start.criterion" title="Link to this definition"></a></dt>
<dd><p>str
The policy that was used to decide when to store the weights.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.starts.start.Start.channels">
<span class="sig-name descname"><span class="pre">channels</span></span><a class="headerlink" href="#dacapo.experiments.starts.start.Start.channels" title="Link to this definition"></a></dt>
<dd><p>int
The number of channels in the input data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.starts.start.Start.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.starts.start.Start.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes the Start class with specified config to run the
initialization of weights for a model associated with a specific
criterion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.starts.start.Start.initialize_weights">
<span class="sig-name descname"><span class="pre">initialize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.starts.start.Start.initialize_weights" title="Link to this definition"></a></dt>
<dd><p>Retrieves the weights from the dacapo store and load them into
the model.</p>
</dd></dl>

<p class="rubric">Notes</p>
<p>This class is used to retrieve and load the weights of the starter
model used for finetuning from the dacapo store.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">channels</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">initialize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Retrieves the weights from the dacapo store and load them into
the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – obj
The model to which the weights are to be loaded.</p></li>
<li><p><strong>new_head</strong> – list
The labels of the new head.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>obj</dt><dd><p>The model with the weights loaded from the dacapo store.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>model</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If weights of a non-existing or mismatched layer are being
loaded, a RuntimeError exception is thrown which is logged
and handled by loading only the common layers from weights.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">initialize_weights</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">new_head</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This function is called by the Start class to retrieve the weights
from the dacapo store and load them into the model.</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../cosem_start_config/index.html" class="btn btn-neutral float-left" title="dacapo.experiments.starts.cosem_start_config" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../start_config/index.html" class="btn btn-neutral float-right" title="dacapo.experiments.starts.start_config" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, William Patton, Jeff Rhoades, Marwan Zouinkhi,  David Ackerman, Caroline Malin-Mayor, Jan Funke.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>