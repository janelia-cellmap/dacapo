

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dacapo.experiments.architectures &mdash; DaCapo  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/custom.css" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="dacapo.experiments.architectures.architecture" href="architecture/index.html" />
    <link rel="prev" title="dacapo.experiments" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            DaCapo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">DaCapo API:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial.html">Tutorial: A Simple Experiment in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docker.html">Docker Configuration for JupyterHub-Dacapo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../aws.html">AWS EC2 Setup Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">dacapo</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../blockwise/index.html">dacapo.blockwise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../compute_context/index.html">dacapo.compute_context</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html">dacapo.experiments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ext/index.html">dacapo.ext</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../gp/index.html">dacapo.gp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../store/index.html">dacapo.store</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html">dacapo.utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#package-contents">Package Contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cli.html">CLI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">DaCapo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">dacapo</a></li>
          <li class="breadcrumb-item"><a href="../index.html">dacapo.experiments</a></li>
      <li class="breadcrumb-item active">dacapo.experiments.architectures</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/dacapo/experiments/architectures/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dacapo.experiments.architectures">
<span id="dacapo-experiments-architectures"></span><h1>dacapo.experiments.architectures<a class="headerlink" href="#module-dacapo.experiments.architectures" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="architecture/index.html">dacapo.experiments.architectures.architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture_config/index.html">dacapo.experiments.architectures.architecture_config</a></li>
<li class="toctree-l1"><a class="reference internal" href="cnnectome_unet/index.html">dacapo.experiments.architectures.cnnectome_unet</a></li>
<li class="toctree-l1"><a class="reference internal" href="cnnectome_unet_config/index.html">dacapo.experiments.architectures.cnnectome_unet_config</a></li>
<li class="toctree-l1"><a class="reference internal" href="dummy_architecture/index.html">dacapo.experiments.architectures.dummy_architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="dummy_architecture_config/index.html">dacapo.experiments.architectures.dummy_architecture_config</a></li>
</ul>
</div>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dacapo.experiments.architectures.Architecture" title="dacapo.experiments.architectures.Architecture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Architecture</span></code></a></p></td>
<td><p>An abstract base class for defining the architecture of a neural network model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dacapo.experiments.architectures.ArchitectureConfig" title="dacapo.experiments.architectures.ArchitectureConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ArchitectureConfig</span></code></a></p></td>
<td><p>A class to represent the base configurations of any architecture. It is used to define the architecture of a neural network model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dacapo.experiments.architectures.DummyArchitectureConfig" title="dacapo.experiments.architectures.DummyArchitectureConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DummyArchitectureConfig</span></code></a></p></td>
<td><p>A dummy architecture configuration class used for testing purposes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dacapo.experiments.architectures.DummyArchitecture" title="dacapo.experiments.architectures.DummyArchitecture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DummyArchitecture</span></code></a></p></td>
<td><p>A class used to represent a dummy architecture layer for a 3D CNN.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dacapo.experiments.architectures.CNNectomeUNetConfig" title="dacapo.experiments.architectures.CNNectomeUNetConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CNNectomeUNetConfig</span></code></a></p></td>
<td><p>This class configures the CNNectomeUNet based on</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dacapo.experiments.architectures.CNNectomeUNet" title="dacapo.experiments.architectures.CNNectomeUNet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CNNectomeUNet</span></code></a></p></td>
<td><p>A U-Net architecture for 3D or 4D data. The U-Net expects 3D or 4D tensors</p></td>
</tr>
</tbody>
</table>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.Architecture">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacapo.experiments.architectures.</span></span><span class="sig-name descname"><span class="pre">Architecture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.Architecture" title="Link to this definition"></a></dt>
<dd><p>An abstract base class for defining the architecture of a neural network model.
It is inherited from PyTorch’s Module and built-in class <cite>ABC</cite> (Abstract Base Classes).
Other classes can inherit this class to define their own specific variations of architecture.
It requires to implement several property methods, and also includes additional methods related to the architecture design.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.Architecture.input_shape">
<span class="sig-name descname"><span class="pre">input_shape</span></span><a class="headerlink" href="#dacapo.experiments.architectures.Architecture.input_shape" title="Link to this definition"></a></dt>
<dd><p>The spatial input shape for the neural network architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Coordinate</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.Architecture.eval_shape_increase">
<span class="sig-name descname"><span class="pre">eval_shape_increase</span></span><a class="headerlink" href="#dacapo.experiments.architectures.Architecture.eval_shape_increase" title="Link to this definition"></a></dt>
<dd><p>The amount to increase the input shape during prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Coordinate</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.Architecture.num_in_channels">
<span class="sig-name descname"><span class="pre">num_in_channels</span></span><a class="headerlink" href="#dacapo.experiments.architectures.Architecture.num_in_channels" title="Link to this definition"></a></dt>
<dd><p>The number of input channels required by the architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.Architecture.num_out_channels">
<span class="sig-name descname"><span class="pre">num_out_channels</span></span><a class="headerlink" href="#dacapo.experiments.architectures.Architecture.num_out_channels" title="Link to this definition"></a></dt>
<dd><p>The number of output channels provided by the architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.Architecture.dims">
<span class="sig-name descname"><span class="pre">dims</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.Architecture.dims" title="Link to this definition"></a></dt>
<dd><p>Returns the number of dimensions of the input shape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.Architecture.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.Architecture.scale" title="Link to this definition"></a></dt>
<dd><p>Scales the input voxel size as required by the architecture.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The class is abstract and requires to implement the abstract methods.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">funlib.geometry.Coordinate</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Abstractmethod<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Abstract method to define the spatial input shape for the neural network architecture.
The shape should not account for the channels and batch dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The spatial input shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Coordinate</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the method is not implemented in the derived class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_shape</span> <span class="o">=</span> <span class="n">Coordinate</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method should be implemented in the derived class.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_shape_increase</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">funlib.geometry.Coordinate</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Provides information about how much to increase the input shape during prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An instance representing the amount to increase in each dimension of the input shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Coordinate</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the method is not implemented in the derived class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eval_shape_increase</span> <span class="o">=</span> <span class="n">Coordinate</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">eval_shape_increase</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method is optional and can be overridden in the derived class.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_in_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Abstractmethod<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Abstract method to return number of input channels required by the architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Required number of input channels.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the method is not implemented in the derived class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_in_channels</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">num_in_channels</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method should be implemented in the derived class.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_out_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Abstractmethod<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Abstract method to return the number of output channels provided by the architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of output channels.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the method is not implemented in the derived class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_out_channels</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">num_out_channels</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method should be implemented in the derived class.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id4">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dims</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Returns the number of dimensions of the input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of dimensions.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the method is not implemented in the derived class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_shape</span> <span class="o">=</span> <span class="n">Coordinate</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">dims</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method is optional and can be overridden in the derived class.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_voxel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">funlib.geometry.Coordinate</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">funlib.geometry.Coordinate</span></span></span><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Method to scale the input voxel size as required by the architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_voxel_size</strong> (<em>Coordinate</em>) – The original size of the input voxel.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The scaled voxel size.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Coordinate</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If the method is not implemented in the derived class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_voxel_size</span> <span class="o">=</span> <span class="n">Coordinate</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">input_voxel_size</span><span class="p">)</span>
<span class="go">Coordinate((1, 1, 1))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method is optional and can be overridden in the derived class.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.ArchitectureConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacapo.experiments.architectures.</span></span><span class="sig-name descname"><span class="pre">ArchitectureConfig</span></span><a class="headerlink" href="#dacapo.experiments.architectures.ArchitectureConfig" title="Link to this definition"></a></dt>
<dd><p>A class to represent the base configurations of any architecture. It is used to define the architecture of a neural network model.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.ArchitectureConfig.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#dacapo.experiments.architectures.ArchitectureConfig.name" title="Link to this definition"></a></dt>
<dd><p>str
a unique name for the architecture.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.ArchitectureConfig.verify">
<span class="sig-name descname"><span class="pre">verify</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.ArchitectureConfig.verify" title="Link to this definition"></a></dt>
<dd><p>validates the given architecture.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The class is abstract and requires to implement the abstract methods.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">verify</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>A method to validate an architecture configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple of a boolean indicating if the architecture is valid and a message.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[bool, str]</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the method is not implemented in the derived class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">ArchitectureConfig</span><span class="p">(</span><span class="s2">&quot;MyModel&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_valid</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">is_valid</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method should be implemented in the derived class.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitectureConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacapo.experiments.architectures.</span></span><span class="sig-name descname"><span class="pre">DummyArchitectureConfig</span></span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitectureConfig" title="Link to this definition"></a></dt>
<dd><p>A dummy architecture configuration class used for testing purposes.</p>
<p>It extends the base class “ArchitectureConfig”. This class contains dummy attributes and always
returns that the configuration is invalid when verified.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitectureConfig.architecture_type">
<span class="sig-name descname"><span class="pre">architecture_type</span></span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitectureConfig.architecture_type" title="Link to this definition"></a></dt>
<dd><p>A class attribute assigning
the DummyArchitecture class to this configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dacapo.experiments.architectures.DummyArchitecture" title="dacapo.experiments.architectures.DummyArchitecture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DummyArchitecture</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitectureConfig.num_in_channels">
<span class="sig-name descname"><span class="pre">num_in_channels</span></span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitectureConfig.num_in_channels" title="Link to this definition"></a></dt>
<dd><p>The number of input channels. This is a dummy attribute and has no real
functionality or meaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitectureConfig.num_out_channels">
<span class="sig-name descname"><span class="pre">num_out_channels</span></span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitectureConfig.num_out_channels" title="Link to this definition"></a></dt>
<dd><p>The number of output channels. This is also a dummy attribute and
has no real functionality or meaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitectureConfig.verify">
<span class="sig-name descname"><span class="pre">verify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitectureConfig.verify" title="Link to this definition"></a></dt>
<dd><p>This method is used to check whether this is a valid architecture configuration.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is used to represent a DummyArchitectureConfig object in the system.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">architecture_type</span></span><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">num_in_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">num_out_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">verify</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd><p>Verifies the configuration validity.</p>
<p>Since this is a dummy configuration for testing purposes, this method always returns False
indicating that the configuration is invalid.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing a boolean validity flag and a reason message string.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – This method is not implemented in this class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_architecture_config</span> <span class="o">=</span> <span class="n">DummyArchitectureConfig</span><span class="p">(</span><span class="n">num_in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_architecture_config</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
<span class="go">(False, &quot;This is a DummyArchitectureConfig and is never valid&quot;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to check whether this is a valid architecture configuration.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitecture">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacapo.experiments.architectures.</span></span><span class="sig-name descname"><span class="pre">DummyArchitecture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">architecture_config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitecture" title="Link to this definition"></a></dt>
<dd><p>A class used to represent a dummy architecture layer for a 3D CNN.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitecture.channels_in">
<span class="sig-name descname"><span class="pre">channels_in</span></span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitecture.channels_in" title="Link to this definition"></a></dt>
<dd><p>An integer representing the number of input channels.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitecture.channels_out">
<span class="sig-name descname"><span class="pre">channels_out</span></span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitecture.channels_out" title="Link to this definition"></a></dt>
<dd><p>An integer representing the number of output channels.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitecture.conv">
<span class="sig-name descname"><span class="pre">conv</span></span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitecture.conv" title="Link to this definition"></a></dt>
<dd><p>A 3D convolution object.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitecture.input_shape">
<span class="sig-name descname"><span class="pre">input_shape</span></span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitecture.input_shape" title="Link to this definition"></a></dt>
<dd><p>A coordinate object representing the shape of the input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitecture.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitecture.forward" title="Link to this definition"></a></dt>
<dd><p>Performs the forward pass of the network.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitecture.num_in_channels">
<span class="sig-name descname"><span class="pre">num_in_channels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitecture.num_in_channels" title="Link to this definition"></a></dt>
<dd><p>Returns the number of input channels for this architecture.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.DummyArchitecture.num_out_channels">
<span class="sig-name descname"><span class="pre">num_out_channels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.DummyArchitecture.num_out_channels" title="Link to this definition"></a></dt>
<dd><p>Returns the number of output channels for this architecture.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is used to represent a dummy architecture layer for a 3D CNN.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">channels_in</span></span><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">channels_out</span></span><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">conv</span></span><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id15">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_shape</span></span><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Returns</span> <span class="pre">the</span> <span class="pre">input</span> <span class="pre">shape</span> <span class="pre">for</span> <span class="pre">this</span> <span class="pre">architecture.</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Input shape of the architecture.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Coordinate</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – This method is not implemented in this class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_architecture</span><span class="o">.</span><span class="n">input_shape</span>
<span class="go">Coordinate(x=40, y=20, z=20)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to return the input shape for this architecture.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id16">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_in_channels</span></span><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Returns</span> <span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">input</span> <span class="pre">channels</span> <span class="pre">for</span> <span class="pre">this</span> <span class="pre">architecture.</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of input channels.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – This method is not implemented in this class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_architecture</span><span class="o">.</span><span class="n">num_in_channels</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to return the number of input channels for this architecture.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id17">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_out_channels</span></span><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Returns</span> <span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">output</span> <span class="pre">channels</span> <span class="pre">for</span> <span class="pre">this</span> <span class="pre">architecture.</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of output channels.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – This method is not implemented in this class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_architecture</span><span class="o">.</span><span class="n">num_out_channels</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to return the number of output channels for this architecture.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>Perform the forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor after the forward pass.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method is not implemented in this class.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_architecture</span> <span class="o">=</span> <span class="n">DummyArchitecture</span><span class="p">(</span><span class="n">architecture_config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_architecture</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to perform the forward pass of the network.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacapo.experiments.architectures.</span></span><span class="sig-name descname"><span class="pre">CNNectomeUNetConfig</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig" title="Link to this definition"></a></dt>
<dd><p>This class configures the CNNectomeUNet based on
<a class="reference external" href="https://github.com/saalfeldlab/CNNectome/blob/master/CNNectome/networks/unet_class.py">https://github.com/saalfeldlab/CNNectome/blob/master/CNNectome/networks/unet_class.py</a></p>
<p>Includes support for super resolution via the upsampling factors.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.input_shape">
<span class="sig-name descname"><span class="pre">input_shape</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.input_shape" title="Link to this definition"></a></dt>
<dd><p>Coordinate
The shape of the data passed into the network during training.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.fmaps_out">
<span class="sig-name descname"><span class="pre">fmaps_out</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.fmaps_out" title="Link to this definition"></a></dt>
<dd><p>int
The number of channels produced by your architecture.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.fmaps_in">
<span class="sig-name descname"><span class="pre">fmaps_in</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.fmaps_in" title="Link to this definition"></a></dt>
<dd><p>int
The number of channels expected from the raw data.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.num_fmaps">
<span class="sig-name descname"><span class="pre">num_fmaps</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.num_fmaps" title="Link to this definition"></a></dt>
<dd><p>int
The number of feature maps in the top level of the UNet.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.fmap_inc_factor">
<span class="sig-name descname"><span class="pre">fmap_inc_factor</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.fmap_inc_factor" title="Link to this definition"></a></dt>
<dd><p>int
The multiplication factor for the number of feature maps for each level of the UNet.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.downsample_factors">
<span class="sig-name descname"><span class="pre">downsample_factors</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.downsample_factors" title="Link to this definition"></a></dt>
<dd><p>List[Coordinate]
The factors to downsample the feature maps along each axis per layer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.kernel_size_down">
<span class="sig-name descname"><span class="pre">kernel_size_down</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.kernel_size_down" title="Link to this definition"></a></dt>
<dd><p>Optional[List[Coordinate]]
The size of the convolutional kernels used before downsampling in each layer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.kernel_size_up">
<span class="sig-name descname"><span class="pre">kernel_size_up</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.kernel_size_up" title="Link to this definition"></a></dt>
<dd><p>Optional[List[Coordinate]]
The size of the convolutional kernels used before upsampling in each layer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig._eval_shape_increase">
<span class="sig-name descname"><span class="pre">_eval_shape_increase</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig._eval_shape_increase" title="Link to this definition"></a></dt>
<dd><p>Optional[Coordinate]
The amount by which to increase the input size when just prediction rather than training.
It is generally possible to significantly increase the input size since we don’t have the memory
constraints of the gradients, the optimizer and the batch size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.upsample_factors">
<span class="sig-name descname"><span class="pre">upsample_factors</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.upsample_factors" title="Link to this definition"></a></dt>
<dd><p>Optional[List[Coordinate]]
The amount by which to upsample the output of the UNet.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.constant_upsample">
<span class="sig-name descname"><span class="pre">constant_upsample</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.constant_upsample" title="Link to this definition"></a></dt>
<dd><p>bool
Whether to use a transpose convolution or simply copy voxels to upsample.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.padding">
<span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.padding" title="Link to this definition"></a></dt>
<dd><p>str
The padding to use in convolution operations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.use_attention">
<span class="sig-name descname"><span class="pre">use_attention</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.use_attention" title="Link to this definition"></a></dt>
<dd><p>bool
Whether to use attention blocks in the UNet. This is supported for 2D and  3D.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.architecture_type">
<span class="sig-name descname"><span class="pre">architecture_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.architecture_type" title="Link to this definition"></a></dt>
<dd><p>Returns the architecture type.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The architecture_type attribute is set to CNNectomeUNet.</p>
</div>
<p class="rubric">References</p>
<p>Saalfeld, S., Fetter, R., Cardona, A., &amp; Tomancak, P. (2012).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">architecture_type</span></span><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">input_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">funlib.geometry.Coordinate</span></em><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">fmaps_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">fmaps_in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">num_fmaps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">fmap_inc_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">downsample_factors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">funlib.geometry.Coordinate</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id25" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">kernel_size_down</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">funlib.geometry.Coordinate</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../tasks/index.html#dacapo.experiments.tasks.OneHotTaskConfig.None" title="dacapo.experiments.tasks.OneHotTaskConfig.None"><span class="pre">None</span></a></em><a class="headerlink" href="#id26" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">kernel_size_up</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">funlib.geometry.Coordinate</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../tasks/index.html#dacapo.experiments.tasks.OneHotTaskConfig.None" title="dacapo.experiments.tasks.OneHotTaskConfig.None"><span class="pre">None</span></a></em><a class="headerlink" href="#id27" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id28">
<span class="sig-name descname"><span class="pre">upsample_factors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">funlib.geometry.Coordinate</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../tasks/index.html#dacapo.experiments.tasks.OneHotTaskConfig.None" title="dacapo.experiments.tasks.OneHotTaskConfig.None"><span class="pre">None</span></a></em><a class="headerlink" href="#id28" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id29">
<span class="sig-name descname"><span class="pre">constant_upsample</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#id29" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id30">
<span class="sig-name descname"><span class="pre">padding</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id30" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id31">
<span class="sig-name descname"><span class="pre">use_attention</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#id31" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNetConfig.batch_norm">
<span class="sig-name descname"><span class="pre">batch_norm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNetConfig.batch_norm" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacapo.experiments.architectures.</span></span><span class="sig-name descname"><span class="pre">CNNectomeUNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">architecture_config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet" title="Link to this definition"></a></dt>
<dd><p>A U-Net architecture for 3D or 4D data. The U-Net expects 3D or 4D tensors
shaped like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>``(batch=1, channels, [length,] depth, height, width)``.
</pre></div>
</div>
<p>This U-Net performs only “valid” convolutions, i.e., sizes of the feature
maps decrease after each convolution. It will perfrom 4D convolutions as
long as <code class="docutils literal notranslate"><span class="pre">length</span></code> is greater than 1. As soon as <code class="docutils literal notranslate"><span class="pre">length</span></code> is 1 due to a
valid convolution, the time dimension will be dropped and tensors with
<code class="docutils literal notranslate"><span class="pre">(b,</span> <span class="pre">c,</span> <span class="pre">z,</span> <span class="pre">y,</span> <span class="pre">x)</span></code> will be use (and returned) from there on.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.fmaps_in">
<span class="sig-name descname"><span class="pre">fmaps_in</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.fmaps_in" title="Link to this definition"></a></dt>
<dd><p>The number of input channels.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.fmaps_out">
<span class="sig-name descname"><span class="pre">fmaps_out</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.fmaps_out" title="Link to this definition"></a></dt>
<dd><p>The number of feature maps in the output layer. This is also the
number of output feature maps. Stored in the <code class="docutils literal notranslate"><span class="pre">channels</span></code> dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.num_fmaps">
<span class="sig-name descname"><span class="pre">num_fmaps</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.num_fmaps" title="Link to this definition"></a></dt>
<dd><p>The number of feature maps in the first layer. This is also the
number of output feature maps. Stored in the <code class="docutils literal notranslate"><span class="pre">channels</span></code> dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.fmap_inc_factor">
<span class="sig-name descname"><span class="pre">fmap_inc_factor</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.fmap_inc_factor" title="Link to this definition"></a></dt>
<dd><p>By how much to multiply the number of feature maps between layers.
If layer 0 has <code class="docutils literal notranslate"><span class="pre">k</span></code> feature maps, layer <code class="docutils literal notranslate"><span class="pre">l</span></code> will have
<code class="docutils literal notranslate"><span class="pre">k*fmap_inc_factor**l</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.downsample_factors">
<span class="sig-name descname"><span class="pre">downsample_factors</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.downsample_factors" title="Link to this definition"></a></dt>
<dd><p>List of tuples <code class="docutils literal notranslate"><span class="pre">(z,</span> <span class="pre">y,</span> <span class="pre">x)</span></code> to use to down- and up-sample the
feature maps between layers.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.kernel_size_down">
<span class="sig-name descname"><span class="pre">kernel_size_down</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.kernel_size_down" title="Link to this definition"></a></dt>
<dd><p>List of lists of kernel sizes. The number of sizes in a list
determines the number of convolutional layers in the corresponding
level of the build on the left side. Kernel sizes can be given as
tuples or integer. If not given, each convolutional pass will
consist of two 3x3x3 convolutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.kernel_size_up">
<span class="sig-name descname"><span class="pre">kernel_size_up</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.kernel_size_up" title="Link to this definition"></a></dt>
<dd><p>List of lists of kernel sizes. The number of sizes in a list
determines the number of convolutional layers in the corresponding
level of the build on the right side. Within one of the lists going
from left to right. Kernel sizes can be given as tuples or integer.
If not given, each convolutional pass will consist of two 3x3x3
convolutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.activation">
<span class="sig-name descname"><span class="pre">activation</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.activation" title="Link to this definition"></a></dt>
<dd><p>Which activation to use after a convolution. Accepts the name of
any tensorflow activation function (e.g., <code class="docutils literal notranslate"><span class="pre">ReLU</span></code> for
<code class="docutils literal notranslate"><span class="pre">torch.nn.ReLU</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.fov">
<span class="sig-name descname"><span class="pre">fov</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.fov" title="Link to this definition"></a></dt>
<dd><p>Initial field of view in physical units</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.voxel_size">
<span class="sig-name descname"><span class="pre">voxel_size</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.voxel_size" title="Link to this definition"></a></dt>
<dd><p>Size of a voxel in the input data, in physical units</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.num_heads">
<span class="sig-name descname"><span class="pre">num_heads</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.num_heads" title="Link to this definition"></a></dt>
<dd><p>Number of decoders. The resulting U-Net has one single encoder
path and num_heads decoder paths. This is useful in a multi-task
learning context.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.constant_upsample">
<span class="sig-name descname"><span class="pre">constant_upsample</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.constant_upsample" title="Link to this definition"></a></dt>
<dd><p>If set to true, perform a constant upsampling instead of a
transposed convolution in the upsampling layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.padding">
<span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.padding" title="Link to this definition"></a></dt>
<dd><p>How to pad convolutions. Either ‘same’ or ‘valid’ (default).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.upsample_channel_contraction">
<span class="sig-name descname"><span class="pre">upsample_channel_contraction</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.upsample_channel_contraction" title="Link to this definition"></a></dt>
<dd><p>When performing the ConvTranspose, whether to reduce the number
of channels by the fmap_increment_factor. can be either bool or
list of bools to apply independently per layer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.activation_on_upsample">
<span class="sig-name descname"><span class="pre">activation_on_upsample</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.activation_on_upsample" title="Link to this definition"></a></dt>
<dd><p>Whether or not to add an activation after the upsample operation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.use_attention">
<span class="sig-name descname"><span class="pre">use_attention</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.use_attention" title="Link to this definition"></a></dt>
<dd><p>Whether or not to use an attention block in the U-Net.</p>
<blockquote>
<div><dl class="simple">
<dt>Methods:</dt><dd><dl class="simple">
<dt>forward(x):</dt><dd><p>Forward pass of the U-Net.</p>
</dd>
<dt>scale(voxel_size):</dt><dd><p>Scale the voxel size according to the upsampling factors.</p>
</dd>
<dt>input_shape:</dt><dd><p>Return the input shape of the U-Net.</p>
</dd>
<dt>num_in_channels:</dt><dd><p>Return the number of input channels.</p>
</dd>
<dt>num_out_channels:</dt><dd><p>Return the number of output channels.</p>
</dd>
<dt>eval_shape_increase:</dt><dd><p>Return the increase in shape due to the U-Net.</p>
</dd>
</dl>
</dd>
<dt>Note:</dt><dd><p>This class is a wrapper around the <code class="docutils literal notranslate"><span class="pre">CNNectomeUNetModule</span></code> class.
The <code class="docutils literal notranslate"><span class="pre">CNNectomeUNetModule</span></code> class is the actual implementation of the
U-Net architecture.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id32">
<span class="sig-name descname"><span class="pre">fmaps_out</span></span><a class="headerlink" href="#id32" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id33">
<span class="sig-name descname"><span class="pre">fmaps_in</span></span><a class="headerlink" href="#id33" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id34">
<span class="sig-name descname"><span class="pre">num_fmaps</span></span><a class="headerlink" href="#id34" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id35">
<span class="sig-name descname"><span class="pre">fmap_inc_factor</span></span><a class="headerlink" href="#id35" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id36">
<span class="sig-name descname"><span class="pre">downsample_factors</span></span><a class="headerlink" href="#id36" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id37">
<span class="sig-name descname"><span class="pre">kernel_size_down</span></span><a class="headerlink" href="#id37" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id38">
<span class="sig-name descname"><span class="pre">kernel_size_up</span></span><a class="headerlink" href="#id38" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id39">
<span class="sig-name descname"><span class="pre">constant_upsample</span></span><a class="headerlink" href="#id39" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id40">
<span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#id40" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.upsample_factors">
<span class="sig-name descname"><span class="pre">upsample_factors</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.upsample_factors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id41">
<span class="sig-name descname"><span class="pre">use_attention</span></span><a class="headerlink" href="#id41" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.batch_norm">
<span class="sig-name descname"><span class="pre">batch_norm</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.batch_norm" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.unet">
<span class="sig-name descname"><span class="pre">unet</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.unet" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.eval_shape_increase">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_shape_increase</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.eval_shape_increase" title="Link to this definition"></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">The</span> <span class="pre">increase</span> <span class="pre">in</span> <span class="pre">shape</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">U-Net.</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The increase in shape due to the U-Net.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AttributeError</strong> – If the increase in shape is not given.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unet</span><span class="o">.</span><span class="n">eval_shape_increase</span>
<span class="go">(1, 1, 128, 128, 128)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The increase in shape should be given as a tuple <code class="docutils literal notranslate"><span class="pre">(batch,</span> <span class="pre">channels,</span> <span class="pre">[length,]</span> <span class="pre">depth,</span> <span class="pre">height,</span> <span class="pre">width)</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.module">
<span class="sig-name descname"><span class="pre">module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.module" title="Link to this definition"></a></dt>
<dd><p>Create the U-Net module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The U-Net module.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AttributeError</strong> – If the number of input channels is not given.</p></li>
<li><p><strong>AttributeError</strong> – If the number of output channels is not given.</p></li>
<li><p><strong>AttributeError</strong> – If the number of feature maps in the first layer is not given.</p></li>
<li><p><strong>AttributeError</strong> – If the factor by which the number of feature maps increases between layers is not given.</p></li>
<li><p><strong>AttributeError</strong> – If the downsample factors are not given.</p></li>
<li><p><strong>AttributeError</strong> – If the kernel sizes for the down pass are not given.</p></li>
<li><p><strong>AttributeError</strong> – If the kernel sizes for the up pass are not given.</p></li>
<li><p><strong>AttributeError</strong> – If the constant upsample flag is not given.</p></li>
<li><p><strong>AttributeError</strong> – If the padding is not given.</p></li>
<li><p><strong>AttributeError</strong> – If the upsample factors are not given.</p></li>
<li><p><strong>AttributeError</strong> – If the activation on upsample flag is not given.</p></li>
<li><p><strong>AttributeError</strong> – If the use attention flag is not given.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unet</span><span class="o">.</span><span class="n">module</span><span class="p">()</span>
<span class="go">CNNectomeUNetModule(</span>
<span class="go">    in_channels=1,</span>
<span class="go">    num_fmaps=24,</span>
<span class="go">    num_fmaps_out=1,</span>
<span class="go">    fmap_inc_factor=2,</span>
<span class="go">    kernel_size_down=[[(3, 3, 3), (3, 3, 3)], [(3, 3, 3), (3, 3, 3)], [(3, 3, 3), (3, 3, 3)]],</span>
<span class="go">    kernel_size_up=[[(3, 3, 3), (3, 3, 3)], [(3, 3, 3), (3, 3, 3)], [(3, 3, 3), (3, 3, 3)]],</span>
<span class="go">    downsample_factors=[(2, 2, 2), (2, 2, 2), (2, 2, 2)],</span>
<span class="go">    constant_upsample=False,</span>
<span class="go">    padding=&#39;valid&#39;,</span>
<span class="go">    activation_on_upsample=True,</span>
<span class="go">    upsample_channel_contraction=[False, True, True],</span>
<span class="go">    use_attention=False</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The U-Net module is an instance of the <code class="docutils literal notranslate"><span class="pre">CNNectomeUNetModule</span></code> class.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.scale" title="Link to this definition"></a></dt>
<dd><p>Scale the voxel size according to the upsampling factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>voxel_size</strong> (<em>tuple</em>) – The size of a voxel in the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The scaled voxel size.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the voxel size is not given.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unet</span><span class="o">.</span><span class="n">scale</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">(1, 1, 1)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The voxel size should be given as a tuple <code class="docutils literal notranslate"><span class="pre">(z,</span> <span class="pre">y,</span> <span class="pre">x)</span></code>.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.input_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_shape</span></span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.input_shape" title="Link to this definition"></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Return</span> <span class="pre">the</span> <span class="pre">input</span> <span class="pre">shape</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">U-Net.</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The input shape of the U-Net.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AttributeError</strong> – If the input shape is not given.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unet</span><span class="o">.</span><span class="n">input_shape</span>
<span class="go">(1, 1, 128, 128, 128)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The input shape should be given as a tuple <code class="docutils literal notranslate"><span class="pre">(batch,</span> <span class="pre">channels,</span> <span class="pre">[length,]</span> <span class="pre">depth,</span> <span class="pre">height,</span> <span class="pre">width)</span></code>.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.num_in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_in_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.num_in_channels" title="Link to this definition"></a></dt>
<dd><p>Return the number of input channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of input channels.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AttributeError</strong> – If the number of input channels is not given.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unet</span><span class="o">.</span><span class="n">num_in_channels</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of input channels should be given as an integer.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.num_out_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_out_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.num_out_channels" title="Link to this definition"></a></dt>
<dd><p>Return the number of output channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of output channels.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AttributeError</strong> – If the number of output channels is not given.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unet</span><span class="o">.</span><span class="n">num_out_channels</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of output channels should be given as an integer.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacapo.experiments.architectures.CNNectomeUNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.experiments.architectures.CNNectomeUNet.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the U-Net.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – The input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The output tensor.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – If the tensors have different dimensions.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unet</span> <span class="o">=</span> <span class="n">CNNectomeUNet</span><span class="p">(</span><span class="n">architecture_config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unet</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The input tensor should be given as a 5D tensor.</p>
</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="dacapo.experiments" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="architecture/index.html" class="btn btn-neutral float-right" title="dacapo.experiments.architectures.architecture" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Caroline Malin-Mayor, Jeff Rhoades, Marwan Zouinkhi, William Patton, David Ackerman, Jan Funke.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>